[
  {
    "id": "1",
    "description": "Initial Setup",
    "children": [
      {
        "id": "1.1",
        "description": "Filesystem",
        "children": [
          {
            "id": "1.1.1",
            "description": "Configure Filesystem Kernel Modules",
            "script": "./scripts/Kernel_Modules.sh",
            "children": [
              {
                "id": "1.1.1.1",
                "description": "Ensure cramfs kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "cramfs"
              },
              {
                "id": "1.1.1.2",
                "description": "Ensure freevxfs kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "freevxfs"
              },
              {
                "id": "1.1.1.3",
                "description": "Ensure hfs kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "hfs"
              },
              {
                "id": "1.1.1.4",
                "description": "Ensure hfsplus kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "hfsplus"
              },
              {
                "id": "1.1.1.5",
                "description": "Ensure jffs2 kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "jffs2"
              },
              {
                "id": "1.1.1.6",
                "description": "Ensure squashfs kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "squashfs"
              },
              {
                "id": "1.1.1.7",
                "description": "Ensure udf kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "udf"
              },
              {
                "id": "1.1.1.8",
                "description": "Ensure usb-storage kernel module is not available",
                "check_type": "kernel_module",
                "module_name": "usb-storage"
              }
            ]
          },
          {
            "id": "1.1.2",
            "description": "Configure Filesystem Partitions",
            "script": "./scripts/FSPartitions.sh",
            "children": [
              {
                "id": "1.1.2.1",
                "description": "Configure /tmp",
                "children": [
                  {
                    "id": "1.1.2.1.1",
                    "description": "Ensure /tmp is separate partition",
                    "check_type": "partition",
                    "mount_point": "/tmp"
                  },
                  {
                    "id": "1.1.2.1.2",
                    "description": "Ensure nodev option set on /tmp partition",
                    "check_type": "mount_option",
                    "mount_point": "/tmp",
                    "mount_option": "nodev",
                    "expected_state": "present"
                  },
                  {
                    "id": "1.1.2.1.3",
                    "description": "Ensure nosuid option is set on /tmp partition",
                    "check_type": "mount_option",
                    "mount_point": "/tmp",
                    "mount_option": "nosuid",
                    "expected_state": "present"
                  },
                  {
                    "id": "1.1.2.1.4",
                    "description": "Ensure noexec option is set on /tmp partition",
                    "check_type": "mount_option",
                    "mount_point": "/tmp",
                    "mount_option": "noexec",
                    "expected_state": "present"
                  }
                ]
              },
              {
                "id": "1.1.2.2",
                "description": "Configure /dev/shm",
                "children": [
                  {
                    "id": "1.1.2.2.1",
                    "description": "Verify /dev/shm is mounted as a separate partition",
                    "check_type": "partition",
                    "mount_point": "/dev/shm"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  {
    "id": "2",
    "description": "Services",
    "children": [
      {
        "id": "2.1",
        "description": "Configure Server Services",
        "children": [
        ]
      }
    ]
  }
]
